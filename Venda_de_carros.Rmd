---
title: "Venda de carros"
author: "Prof. MSc. Edgar Luiz de Lima"
date: "21/03/2022"
output:
  pdf_document: default
  html_document: default
---

# Preparação dos dados para as análises exploratórias

Definindo diretório e carregando os pacotes necessários.
```{r}
setwd("C:\\Users\\Edgar\\OneDrive - unb.br\\Venda_de_carros\\Venda_de_Carros")
library(openxlsx)
library(tidyverse)
```


Carregando e visualizando os dados.
```{r}
dados<- read.xlsx("DadosVendaCarros.xlsx")
View(dados)
str(dados)
```


Construindo o conjunto de dados para avaliar o total de vendas por ano. Irei preparar também um conjunto de dados do total de vendas por ano para a marca Jaguar.
```{r}
# Criando a matriz com o número de vendas por ano para todas as marcas.
TVanos<- data.frame(table(dados$Ano))
names(TVanos)<- c("Ano","Total")

# Criando a matriz do número de vendas por ano do carros da marca Jaguar.
TVAjaguar<- dados%>%filter(Fabricante=="Jaguar")%>%
  select(Ano)%>%table()%>%data.frame()
names(TVAjaguar)<- c("Ano","Total")

#Juntando em um mesmo dataframe
vanuais<-rbind.data.frame(TVanos,TVAjaguar)
vanuais<- rep(c("Total","Jaguar"), each= 4)%>%data.frame(vanuais)
names(vanuais)<- c("Escala","Ano","Total")
```

Checando a estrutura dos dados
```{r}
str(vanuais)
```
Transformando Escala em fator e ano em numérico.
```{r}
vanuais$Escala<- as.factor(vanuais$Escala)
vanuais$Ano<- as.numeric(as.character(vanuais$Ano))
str(vanuais)
```
Gerando a planilha de custo de entrega de veículos por fabricante.
```{r}
entrega<- dados%>% select(Fabricante,ValorCusto)%>% group_by(Fabricante)%>%
  summarise(valor_entrega= mean(ValorCusto))
```


# Análise gráfica dos dados

Analise gráfica do padrão temporal de vendas.
```{r}
ggplot(vanuais, aes(Ano, Total,colour= Escala))+
  geom_line(size= 1)+
  geom_point(size= 4)+
  scale_y_continuous(limits = c(10,240), breaks = seq(10,240,20))+
  annotate("text", x = vanuais$Ano, y =vanuais$Total+11, 
           label = vanuais$Total, size= 5)+
  ylab("Total de vendas")+
  theme_bw()+
  theme(panel.grid= element_blank(), axis.title = element_text(size= 16),
        axis.text = element_text(size= 14, color = "black"), legend.title= element_blank(),
        legend.text = element_text(size = 14))
```



